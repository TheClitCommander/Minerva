<!DOCTYPE html>
<html>
<head>
    <title>Minerva Simple Memory Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1 {
            color: #94a3b8;
            border-bottom: 1px solid #334155;
            padding-bottom: 10px;
        }
        
        .container {
            display: flex;
            gap: 20px;
            height: 70vh;
        }
        
        .chat-section {
            flex: 2;
            background-color: #1e293b;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
        }
        
        .memory-section {
            flex: 1;
            background-color: #1e293b;
            border-radius: 8px;
            overflow-y: auto;
            padding: 15px;
        }
        
        .memory-section h2 {
            color: #94a3b8;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            padding: 10px 15px;
            border-radius: 8px;
            max-width: 80%;
            line-height: 1.5;
        }
        
        .user-message {
            background-color: #2563eb;
            color: white;
            align-self: flex-end;
        }
        
        .assistant-message {
            background-color: #334155;
            color: #e2e8f0;
            align-self: flex-start;
        }
        
        .system-message {
            background-color: #475569;
            color: #e2e8f0;
            font-size: 0.9rem;
            align-self: center;
        }
        
        .chat-input {
            display: flex;
            padding: 10px;
            background-color: #334155;
            gap: 10px;
        }
        
        input {
            flex: 1;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #475569;
            background-color: #1e293b;
            color: white;
        }
        
        button {
            padding: 10px 20px;
            background-color: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #2563eb;
        }
        
        .memory-item {
            background-color: #334155;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        
        .memory-content {
            margin-bottom: 8px;
        }
        
        .memory-meta {
            font-size: 0.8rem;
            color: #94a3b8;
            display: flex;
            gap: 8px;
        }
        
        .memory-tag {
            background-color: #6d28d9;
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Minerva Think Tank Memory Demo</h1>
    
    <div class="container">
        <div class="chat-section">
            <div class="chat-messages" id="chat-messages">
                <div class="system-message">Welcome to Minerva! Try telling me something about yourself.</div>
            </div>
            <div class="chat-input">
                <input type="text" id="user-input" placeholder="Type your message...">
                <button id="send-button">Send</button>
            </div>
        </div>
        
        <div class="memory-section">
            <h2>Memory Storage</h2>
            <div id="memories-list">
                <div class="system-message">No memories stored yet.</div>
            </div>
        </div>
    </div>
    
    <script>
        // DOM elements
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const memoriesList = document.getElementById('memories-list');
        
        // Memory storage
        let memories = [];
        
        // Event listeners
        sendButton.addEventListener('click', handleSend);
        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') handleSend();
        });
        
        // Handle sending a message
        function handleSend() {
            const message = userInput.value.trim();
            if (!message) return;
            
            // Add user message
            addMessage(message, 'user');
            userInput.value = '';
            
            // Simulate Think Tank processing
            setTimeout(() => {
                // Extract and store facts
                const facts = extractFacts(message);
                if (facts.length > 0) {
                    facts.forEach(fact => {
                        storeMemory(fact);
                    });
                    updateMemoryDisplay();
                }
                
                // Generate response
                const relevantMemories = getRelevantMemories(message);
                const response = generateResponse(message, relevantMemories);
                addMessage(response, 'assistant');
            }, 1000);
        }
        
        // Add a message to the chat
        function addMessage(text, sender) {
            const message = document.createElement('div');
            message.className = `message ${sender}-message`;
            message.textContent = text;
            chatMessages.appendChild(message);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Extract facts from user message
        function extractFacts(message) {
            const facts = [];
            
            // Name extraction
            if (message.toLowerCase().includes('my name is')) {
                const match = message.match(/my name is ([a-z\s]+)/i);
                if (match && match[1]) {
                    facts.push({
                        content: `User's name is ${match[1].trim()}`,
                        category: 'personal',
                        tags: ['name']
                    });
                }
            }
            
            // Preference extraction
            if (message.toLowerCase().includes('i like') || message.toLowerCase().includes('i love')) {
                const match = message.match(/i (like|love) ([a-z\s]+)/i);
                if (match && match[2]) {
                    facts.push({
                        content: `User likes ${match[2].trim()}`,
                        category: 'preferences',
                        tags: ['likes']
                    });
                }
            }
            
            // Work extraction
            if (message.toLowerCase().includes('i work')) {
                const match = message.match(/i work (as|at|in) ([a-z\s]+)/i);
                if (match && match[2]) {
                    facts.push({
                        content: `User works ${match[1]} ${match[2].trim()}`,
                        category: 'professional',
                        tags: ['work']
                    });
                }
            }
            
            return facts;
        }
        
        // Store memory
        function storeMemory(memory) {
            memory.id = Date.now();
            memory.created = new Date();
            memory.accessed = 0;
            memories.push(memory);
            
            // Notify
            setTimeout(() => {
                addMessage(`I'll remember that ${memory.content}.`, 'system');
            }, 500);
        }
        
        // Update memory display
        function updateMemoryDisplay() {
            memoriesList.innerHTML = '';
            
            if (memories.length === 0) {
                memoriesList.innerHTML = '<div class="system-message">No memories stored yet.</div>';
                return;
            }
            
            memories.forEach(memory => {
                const item = document.createElement('div');
                item.className = 'memory-item';
                
                const content = document.createElement('div');
                content.className = 'memory-content';
                content.textContent = memory.content;
                
                const meta = document.createElement('div');
                meta.className = 'memory-meta';
                meta.innerHTML = `
                    <span>Category: ${memory.category}</span>
                    <span>Access: ${memory.accessed}x</span>
                `;
                
                const tags = document.createElement('div');
                memory.tags.forEach(tag => {
                    const tagEl = document.createElement('span');
                    tagEl.className = 'memory-tag';
                    tagEl.textContent = tag;
                    meta.appendChild(tagEl);
                });
                
                item.appendChild(content);
                item.appendChild(meta);
                memoriesList.appendChild(item);
            });
        }
        
        // Get relevant memories
        function getRelevantMemories(query) {
            query = query.toLowerCase();
            
            // Update access count for relevant memories
            const relevant = memories.filter(memory => {
                const isRelevant = memory.content.toLowerCase().includes(query) ||
                                memory.tags.some(tag => query.includes(tag));
                if (isRelevant) {
                    memory.accessed += 1;
                }
                return isRelevant;
            });
            
            updateMemoryDisplay();
            return relevant;
        }
        
        // Generate response based on message and memories
        function generateResponse(message, relevantMemories) {
            message = message.toLowerCase();
            
            // Use relevant memories
            if (relevantMemories.length > 0) {
                const memoryText = relevantMemories.map(m => m.content).join('. ');
                
                if (message.includes('what do you know about me') || 
                    message.includes('who am i') || 
                    message.includes('what is my name')) {
                    return `Based on our conversation, I know: ${memoryText}`;
                }
                
                return `I remember that ${memoryText}. How can I help you with that?`;
            }
            
            // Greetings
            if (message.match(/^(hey|hello|hi|howdy|greetings)/)) {
                const nameMemory = memories.find(m => m.content.toLowerCase().includes('name'));
                if (nameMemory) {
                    const name = nameMemory.content.split('is ')[1];
                    return `Hello ${name}! How can I help you today?`;
                }
                return 'Hello! How can I help you today?';
            }
            
            // Factual questions
            if (message.includes('capital of maine')) {
                return 'The capital of Maine is Augusta.';
            }
            if (message.includes('capital of')) {
                const state = message.split('capital of ')[1]?.trim();
                if (state) {
                    const capitals = {
                        'alabama': 'Montgomery',
                        'alaska': 'Juneau',
                        'arizona': 'Phoenix',
                        'arkansas': 'Little Rock',
                        'california': 'Sacramento',
                        'colorado': 'Denver',
                        'connecticut': 'Hartford',
                        'delaware': 'Dover',
                        'florida': 'Tallahassee',
                        'georgia': 'Atlanta',
                        'hawaii': 'Honolulu',
                        'idaho': 'Boise',
                        'illinois': 'Springfield',
                        'indiana': 'Indianapolis',
                        'iowa': 'Des Moines',
                        'kansas': 'Topeka',
                        'kentucky': 'Frankfort',
                        'louisiana': 'Baton Rouge',
                        'maine': 'Augusta',
                        'maryland': 'Annapolis',
                        'massachusetts': 'Boston',
                        'michigan': 'Lansing',
                        'minnesota': 'Saint Paul',
                        'mississippi': 'Jackson',
                        'missouri': 'Jefferson City',
                        'montana': 'Helena',
                        'nebraska': 'Lincoln',
                        'nevada': 'Carson City',
                        'new hampshire': 'Concord',
                        'new jersey': 'Trenton',
                        'new mexico': 'Santa Fe',
                        'new york': 'Albany',
                        'north carolina': 'Raleigh',
                        'north dakota': 'Bismarck',
                        'ohio': 'Columbus',
                        'oklahoma': 'Oklahoma City',
                        'oregon': 'Salem',
                        'pennsylvania': 'Harrisburg',
                        'rhode island': 'Providence',
                        'south carolina': 'Columbia',
                        'south dakota': 'Pierre',
                        'tennessee': 'Nashville',
                        'texas': 'Austin',
                        'utah': 'Salt Lake City',
                        'vermont': 'Montpelier',
                        'virginia': 'Richmond',
                        'washington': 'Olympia',
                        'west virginia': 'Charleston',
                        'wisconsin': 'Madison',
                        'wyoming': 'Cheyenne'
                    };
                    
                    if (capitals[state]) {
                        return `The capital of ${state.charAt(0).toUpperCase() + state.slice(1)} is ${capitals[state]}.`;
                    }
                }
                return "I'm not sure about that capital. Could you be more specific?";
            }
            
            // General knowledge questions
            if (message.includes('what') || message.includes('who') || message.includes('where') || 
                message.includes('when') || message.includes('why') || message.includes('how')) {
                return "That's a good question. I'm currently operating in demo mode with limited knowledge access. In the full Think Tank implementation, I'd connect to multiple AI models to provide a comprehensive answer.";
            }
            
            // Default response
            return "I've received your message. In the full Think Tank implementation, I would provide a more detailed response by combining results from multiple AI models.";
        }
    </script>
</body>
</html>
