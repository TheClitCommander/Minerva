<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MinervaUI Test</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            height: 100%;
            background: radial-gradient(circle at center, #131c2e 0%, #0a0e17 100%);
            color: #e6e6e6;
        }
        #think-tank-container {
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>
    <div id="think-tank-container"></div>
    <div id="debug-info" style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 4px; font-family: monospace; z-index: 9999;">Loading debug info...</div>

    <!-- React -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/three@0.159.0/build/three.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- React Three Fiber and Drei -->
    <script src="https://unpkg.com/@react-three/fiber@8.15.12/dist/react-three-fiber.min.js"></script>
    <script src="https://unpkg.com/@react-three/drei@9.92.3/index.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Extract just the Think Tank component from MinervaUI -->
    <!-- Debug version to identify any issues -->
    <script type="text/javascript">
        console.log('Script loaded - checking React initialization');
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded - React available?', typeof React !== 'undefined');
            console.log('ReactDOM available?', typeof ReactDOM !== 'undefined');
            console.log('THREE available?', typeof THREE !== 'undefined');
            document.getElementById('debug-info').innerHTML = `
                React: ${typeof React !== 'undefined' ? React.version : 'Not loaded'}<br>
                ReactDOM: ${typeof ReactDOM !== 'undefined' ? ReactDOM.version : 'Not loaded'}<br>
                THREE: ${typeof THREE !== 'undefined' ? 'Loaded' : 'Not loaded'}
            `;
        });
    </script>
    
    <script type="text/babel">
        // The useState, useEffect, useRef hooks
        const { useState, useEffect, useRef } = React;
        const { Canvas, useThree, useFrame } = ReactThreeF;
        const { OrbitControls, Html } = drei;

        // Simplified ThinkTank component based on our fixed MinervaUI.jsx
        function ThinkTank() {
            const [active, setActive] = useState(true);
            const [expanded, setExpanded] = useState(true);
            const [data, setData] = useState([
                { 
                    name: "Claude 3 Opus", 
                    score: 9.4, 
                    metrics: { quality: 94, relevance: 93, technical: 91, coherence: 95, helpfulness: 92 }, 
                    capabilities: ["Research", "Analysis", "Reasoning"],
                    reasoning: "Best overall quality with excellent structure and coherence. Strong technical accuracy with minimal AI self-references.",
                    active: true
                },
                { 
                    name: "GPT-4 Turbo", 
                    score: 9.2, 
                    metrics: { quality: 92, relevance: 95, technical: 89, coherence: 87, helpfulness: 94 }, 
                    capabilities: ["Code", "Creative", "Problem-Solving"],
                    reasoning: "Highest relevance and excellent code examples. Used for technical sections of the blended response."
                },
                { 
                    name: "Gemini Pro", 
                    score: 8.7, 
                    metrics: { quality: 87, relevance: 89, technical: 85, coherence: 84, helpfulness: 86 }, 
                    capabilities: ["Fast", "Concise", "Web Knowledge"],
                    reasoning: "Contributed supplementary information and alternative perspectives to the blended response."
                }
            ]);
            
            // Calculate blend percentages based on scores
            const totalScore = data.reduce((sum, model) => sum + model.score, 0);
            const blendPercentages = data.map(model => ({
                name: model.name,
                percentage: Math.round((model.score / totalScore) * 100)
            }));
            
            // This would be wired up to show active models in the Think Tank
            const activeModels = data.filter(model => model.active).map(model => model.name);
            
            return (
                <div style={{ 
                    width: expanded ? '400px' : '220px',
                    backdropFilter: 'blur(8px)',
                    WebkitBackdropFilter: 'blur(8px)',
                    background: 'rgba(10, 10, 30, 0.75)',
                    boxShadow: `0 0 20px rgba(111, 66, 193, ${active ? '0.6' : '0.2'})`,
                    border: '1px solid rgba(111, 66, 193, 0.4)',
                    borderRadius: '12px',
                    padding: '0',
                    overflow: 'hidden',
                    transition: 'all 0.3s ease'
                }}>
                    {/* Header Bar */}
                    <div style={{ 
                        background: 'linear-gradient(90deg, rgba(111, 66, 193, 0.8) 0%, rgba(74, 107, 223, 0.8) 100%)',
                        padding: '12px 15px',
                        display: 'flex', 
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        borderBottom: '1px solid rgba(111, 66, 193, 0.6)',
                        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)'
                    }}>
                        <div style={{ 
                            fontWeight: 'bold', 
                            fontSize: '14px',
                            display: 'flex',
                            alignItems: 'center',
                            color: 'white',
                            textShadow: '0 0 10px rgba(111, 66, 193, 0.8)'
                        }}>
                            <i className="fas fa-brain" style={{ 
                                marginRight: '10px',
                                fontSize: '16px',
                                color: 'white',
                                textShadow: '0 0 15px rgba(255, 255, 255, 0.8)'
                            }}></i>
                            Think Tank Insights
                        </div>
                        <div style={{ display: 'flex', gap: '8px' }}>
                            <button 
                                onClick={() => setExpanded(!expanded)}
                                style={{
                                    background: 'none',
                                    border: 'none',
                                    color: 'white',
                                    cursor: 'pointer',
                                    padding: '0px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    width: '20px',
                                    height: '20px',
                                    borderRadius: '4px',
                                    transition: 'all 0.2s'
                                }}
                            >
                                <i className={`fas fa-${expanded ? 'compress-alt' : 'expand-alt'}`}></i>
                            </button>
                        </div>
                    </div>
                    
                    {/* Model Metrics */}
                    <div style={{ padding: '15px' }}>
                        <div style={{ marginBottom: '20px' }}>
                            <h3 style={{ 
                                margin: '0 0 10px 0', 
                                fontSize: '14px',
                                color: '#a892e0',
                                fontWeight: 'bold'
                            }}>Model Evaluation</h3>
                            
                            {data.map((model, index) => (
                                <div key={index} style={{ 
                                    marginBottom: '12px',
                                    padding: '10px',
                                    background: 'rgba(20, 20, 40, 0.4)',
                                    borderRadius: '8px',
                                    border: model.active ? '1px solid rgba(111, 66, 193, 0.4)' : '1px solid rgba(50, 50, 80, 0.4)'
                                }}>
                                    <div style={{ 
                                        display: 'flex', 
                                        justifyContent: 'space-between', 
                                        alignItems: 'center',
                                        marginBottom: '6px'
                                    }}>
                                        <div style={{ 
                                            fontWeight: 'bold', 
                                            color: model.active ? '#a892e0' : '#8899aa',
                                            fontSize: '13px'
                                        }}>
                                            {model.name}
                                        </div>
                                        <div style={{ 
                                            color: model.active ? '#a892e0' : '#8899aa',
                                            background: model.active ? 'rgba(111, 66, 193, 0.2)' : 'rgba(50, 50, 80, 0.2)',
                                            padding: '2px 6px',
                                            borderRadius: '10px',
                                            fontSize: '12px',
                                            fontWeight: 'bold'
                                        }}>
                                            {model.score.toFixed(1)}
                                        </div>
                                    </div>
                                    
                                    {/* Quality Metrics */}
                                    <div style={{ display: 'flex', gap: '6px', marginBottom: '8px' }}>
                                        {Object.entries(model.metrics).map(([key, value], i) => (
                                            <div key={i} style={{ 
                                                fontSize: '10px',
                                                background: 'rgba(40, 40, 60, 0.5)',
                                                padding: '2px 5px',
                                                borderRadius: '4px',
                                                color: getMetricColor(key, value)
                                            }}>
                                                {key.charAt(0).toUpperCase() + key.slice(1)}: {value}
                                            </div>
                                        ))}
                                    </div>
                                    
                                    {/* Capabilities */}
                                    <div style={{ display: 'flex', gap: '4px', marginBottom: '8px', flexWrap: 'wrap' }}>
                                        {model.capabilities.map((capability, i) => (
                                            <div key={i} style={{
                                                fontSize: '9px',
                                                background: 'rgba(74, 107, 223, 0.2)',
                                                border: '1px solid rgba(74, 107, 223, 0.4)',
                                                padding: '1px 4px',
                                                borderRadius: '4px',
                                                color: '#a0b0f0'
                                            }}>
                                                {capability}
                                            </div>
                                        ))}
                                    </div>
                                    
                                    {/* Reasoning */}
                                    <div style={{ 
                                        fontSize: '11px',
                                        color: '#8899aa',
                                        lineHeight: '1.4',
                                        padding: '5px',
                                        background: 'rgba(30, 30, 50, 0.3)',
                                        borderRadius: '4px'
                                    }}>
                                        {model.reasoning}
                                    </div>
                                </div>
                            ))}
                        </div>
                        
                        {/* Response Blending Visualization */}
                        <div>
                            <h3 style={{ 
                                margin: '0 0 10px 0', 
                                fontSize: '14px',
                                color: '#a892e0',
                                fontWeight: 'bold'
                            }}>Response Blending</h3>
                            
                            <div style={{ 
                                background: 'rgba(20, 20, 40, 0.4)',
                                borderRadius: '8px',
                                padding: '10px',
                                border: '1px solid rgba(74, 107, 223, 0.4)'
                            }}>
                                {blendPercentages.map((item, index) => (
                                    <div key={index} style={{ marginBottom: '8px' }}>
                                        <div style={{ 
                                            display: 'flex', 
                                            justifyContent: 'space-between',
                                            fontSize: '12px',
                                            marginBottom: '3px'
                                        }}>
                                            <span style={{ color: '#a0b0e0' }}>{item.name}</span>
                                            <span style={{ color: '#a0b0e0' }}>{item.percentage}%</span>
                                        </div>
                                        <div style={{ 
                                            background: 'rgba(40, 40, 60, 0.5)',
                                            borderRadius: '4px',
                                            height: '6px',
                                            overflow: 'hidden'
                                        }}>
                                            <div style={{
                                                width: `${item.percentage}%`,
                                                height: '100%',
                                                background: getModelColor(item.name),
                                                borderRadius: '4px'
                                            }}></div>
                                        </div>
                                    </div>
                                ))}
                                
                                <div style={{ 
                                    fontSize: '11px',
                                    color: '#8899aa',
                                    marginTop: '10px',
                                    padding: '5px',
                                    background: 'rgba(30, 30, 50, 0.3)',
                                    borderRadius: '4px',
                                    lineHeight: '1.4'
                                }}>
                                    Blended response combines Claude's coherence, GPT-4's code sections, and Gemini's supplementary information.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Utility functions
        function getMetricColor(metric, value) {
            if (value >= 90) return '#72e872';
            if (value >= 80) return '#a0e0a0';
            if (value >= 70) return '#e8e872';
            return '#e87272';
        }
        
        function getModelColor(name) {
            if (name.includes('Claude')) return 'rgba(156, 93, 219, 0.8)';
            if (name.includes('GPT')) return 'rgba(25, 195, 125, 0.8)';
            if (name.includes('Gemini')) return 'rgba(66, 133, 244, 0.8)';
            if (name.includes('Llama')) return 'rgba(227, 116, 0, 0.8)';
            return 'rgba(111, 66, 193, 0.8)';
        }
        
        // Create and render the app
        const App = () => {
            return (
                <div style={{ width: '100%', height: '100%', display: 'flex', justifyContent: 'center', alignItems: 'center' }}>
                    <ThinkTank />
                </div>
            );
        };

        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM loaded! Trying to render Think Tank...");
            try {
                const container = document.getElementById('think-tank-container');
                // Check if we're using React 18+ or an older version
                if (typeof ReactDOM.createRoot === 'function') {
                    console.log("Using React 18+ with createRoot");
                    const root = ReactDOM.createRoot(container);
                    root.render(<App />);
                } else {
                    console.log("Using older React version with render");
                    ReactDOM.render(<App />, container);
                }
                console.log("Think Tank rendered successfully!");
                document.getElementById('debug-info').innerHTML += '<br>✅ Render attempt completed';
            } catch (err) {
                console.error("Error rendering Think Tank:", err);
                document.getElementById('debug-info').innerHTML += `<br>❌ Error: ${err.message}`;
            }
        });
    </script>
</body>
</html>
