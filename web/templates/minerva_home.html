<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minerva - Advanced Thinking Environment</title>
    <link rel="stylesheet" href="/static/css/reset.css">
    <link rel="stylesheet" href="/static/css/orbital-enhanced.css">
    <link rel="stylesheet" href="/static/css/holographic-ui.css">
    <link rel="stylesheet" href="/static/css/chat-integrated.css">
    <script src="/static/js/libs/three.min.js"></script>
    <script src="/static/js/libs/socket.io.min.js"></script>
</head>
<body class="space-background">
    <!-- Deep Space Background with Milky Way style -->
    <style>
        #space-bg-container {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: -1;
            background-color: black;
            overflow: hidden;
        }
        
        .galaxy-arm {
            position: absolute;
            top: 50%;
            left: 50%;
            border-radius: 50%;
            opacity: 0.7;
            background: radial-gradient(ellipse at center, rgba(100, 149, 237, 0.1) 0%, rgba(100, 149, 237, 0) 70%);
        }
        
        /* Portal Button Styling */
        .nav-portal-button {
            margin: 10px 0 20px 0;
            text-align: center;
        }
        
        .portal-link {
            display: inline-flex;
            align-items: center;
            padding: 8px 15px;
            background: rgba(30, 50, 100, 0.4);
            border: 1px solid rgba(100, 149, 237, 0.5);
            border-radius: 20px;
            color: #fff;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(100, 149, 237, 0.2);
        }
        
        .portal-link:hover {
            background: rgba(40, 70, 130, 0.6);
            border-color: rgba(100, 149, 237, 0.8);
            box-shadow: 0 0 15px rgba(100, 149, 237, 0.4);
            transform: translateY(-2px);
        }
        
        .portal-icon {
            font-size: 16px;
            margin-right: 8px;
        }
        
        .portal-text {
            font-weight: 500;
        }
    </style>
    
    <div id="space-bg-container">
        <!-- Radial gradient overlay -->
        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: radial-gradient(circle at center, 
                rgba(50, 50, 120, 0.3) 0%, 
                rgba(20, 20, 60, 0.2) 40%, 
                rgba(5, 5, 30, 0.1) 70%, 
                rgba(0, 0, 10, 0) 100%);"></div>
                
        <!-- Galaxy arms -->
        <div class="galaxy-arm" style="width: 1000px; height: 400px; transform: translate(-50%, -50%) rotate(0deg);"></div>
        <div class="galaxy-arm" style="width: 1000px; height: 350px; transform: translate(-50%, -50%) rotate(72deg);"></div>
        <div class="galaxy-arm" style="width: 900px; height: 300px; transform: translate(-50%, -50%) rotate(144deg);"></div>
        <div class="galaxy-arm" style="width: 950px; height: 320px; transform: translate(-50%, -50%) rotate(216deg);"></div>
        <div class="galaxy-arm" style="width: 1000px; height: 380px; transform: translate(-50%, -50%) rotate(288deg);"></div>
    </div>

    <!-- Main Container -->
    <div class="minerva-container">
        
        <!-- Side Navigation -->
        <div class="side-nav holographic">
            <div class="nav-logo">
                <img src="/static/img/minerva-logo.svg" alt="Minerva">
                <h1>MINERVA</h1>
            </div>
            
            <div class="nav-portal-button">
                <a href="/minerva-portal" class="portal-link" title="Return to Minerva Portal">
                    <span class="portal-icon">üè†</span>
                    <span class="portal-text">Portal</span>
                </a>
            </div>
            
            <nav class="nav-items">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <div class="nav-icon dashboard-icon"></div>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="projects">
                    <div class="nav-icon projects-icon"></div>
                    <span>Projects</span>
                </a>
                <a href="#" class="nav-item" data-view="think-tank">
                    <div class="nav-icon think-tank-icon"></div>
                    <span>Think Tank</span>
                </a>
                <a href="#" class="nav-item" data-view="settings">
                    <div class="nav-icon settings-icon"></div>
                    <span>Settings</span>
                </a>
            </nav>
            
            <div class="model-selection holographic">
                <h3>Think Tank Models</h3>
                <label>
                    <input type="checkbox" checked data-model="gpt-4"> 
                    <span>GPT-4</span>
                </label>
                <label>
                    <input type="checkbox" checked data-model="claude-3"> 
                    <span>Claude 3</span>
                </label>
                <label>
                    <input type="checkbox" checked data-model="gemini"> 
                    <span>Gemini</span>
                </label>
                <label>
                    <input type="checkbox" checked data-model="llama-3"> 
                    <span>Llama 3</span>
                </label>
                <div class="blend-option">
                    <label>
                        <input type="checkbox" checked id="blend-models"> 
                        <span>Enable Blending</span>
                    </label>
                </div>
            </div>
        </div>
        
        <!-- Main Content Area -->
        <div class="main-content">
            
            <!-- 3D Orbital UI Container -->
            <div id="minerva-orbital-ui" class="orbital-container">
                <div id="minerva-3d-root"></div>
                <div class="orbital-ui-overlay">
                    <div class="minerva-greeting">
                        <h2>Welcome to the Orbital Workspace</h2>
                        <p>Your enhanced thinking environment is ready</p>
                    </div>
                </div>
            </div>
            
            <!-- Projects Grid (Hidden initially) -->
            <div id="projects-grid" class="view-section hidden">
                <div class="grid-header holographic">
                    <h2>Project Collection</h2>
                    <button id="create-project-btn" class="holo-button">+ New Project</button>
                </div>
                <div id="projects-container" class="projects-grid">
                    <!-- Projects will be inserted here dynamically -->
                </div>
            </div>
            
            <!-- Think Tank Section (Hidden initially) -->
            <div id="think-tank-view" class="view-section hidden">
                <div class="think-tank-header holographic">
                    <h2>Think Tank Analysis</h2>
                    <div class="model-metrics-tabs">
                        <button class="tab-button active" data-tab="performance">Performance</button>
                        <button class="tab-button" data-tab="comparison">Comparison</button>
                        <button class="tab-button" data-tab="history">History</button>
                    </div>
                </div>
                <div class="think-tank-metrics">
                    <div class="metric-section" id="performance-metrics">
                        <div class="metrics-grid">
                            <div class="metric-card holographic">
                                <h3>Response Quality</h3>
                                <canvas id="quality-chart" width="280" height="200"></canvas>
                            </div>
                            <div class="metric-card holographic">
                                <h3>Response Times</h3>
                                <canvas id="time-chart" width="280" height="200"></canvas>
                            </div>
                            <div class="metric-card holographic">
                                <h3>Model Usage</h3>
                                <canvas id="usage-chart" width="280" height="200"></canvas>
                            </div>
                            <div class="metric-card holographic">
                                <h3>Query Types</h3>
                                <canvas id="query-type-chart" width="280" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Settings Section (Hidden initially) -->
            <div id="settings-view" class="view-section hidden">
                <div class="settings-header holographic">
                    <h2>System Settings</h2>
                </div>
                <div class="settings-grid">
                    <div class="settings-card holographic">
                        <h3>Interface Settings</h3>
                        <div class="setting-item">
                            <label for="orbital-quality">Orbital UI Quality</label>
                            <select id="orbital-quality">
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" checked id="enable-animations"> 
                                <span>Enable Animations</span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-card holographic">
                        <h3>Memory Settings</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" checked id="enable-memory"> 
                                <span>Enable Conversation Memory</span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label for="memory-depth">Memory Depth</label>
                            <select id="memory-depth">
                                <option value="deep">Deep (30 days)</option>
                                <option value="medium" selected>Medium (14 days)</option>
                                <option value="shallow">Shallow (7 days)</option>
                            </select>
                        </div>
                    </div>
                    <div class="settings-card holographic">
                        <h3>API Settings</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" checked id="enable-web-research"> 
                                <span>Enable Web Research</span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label for="research-depth">Research Depth</label>
                            <select id="research-depth">
                                <option value="deep">Deep</option>
                                <option value="medium" selected>Medium</option>
                                <option value="shallow">Shallow</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Integrated Floating Chat -->
        <div id="integrated-chat" class="chat-container holographic">
            <div class="chat-header">
                <h3>Minerva Assistant</h3>
                <div class="chat-controls">
                    <button id="minimize-chat" class="chat-control-button">_</button>
                    <button id="expand-chat" class="chat-control-button">‚ñ°</button>
                </div>
            </div>
            <div id="chat-history" class="chat-history">
                <div class="message bot-message welcome-message">
                    <div class="message-content">
                        <p>Welcome to Minerva. How can I assist your thinking today?</p>
                    </div>
                </div>
                <!-- Messages will be added here dynamically -->
            </div>
            <div id="typing-indicator" class="typing-indicator hidden">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="chat-input-area">
                <textarea id="chat-input" placeholder="Ask anything..." rows="1"></textarea>
                <button id="send-button" class="holo-button send-button">
                    <span class="send-icon">‚ü©</span>
                </button>
            </div>
            <div class="model-info">
                <span id="connection-status" class="status-indicator connected">Connected</span>
                <span id="selected-model">Think Tank</span>
            </div>
        </div>
        
        <!-- Project-specific Chat (hidden until project is selected) -->
        <div id="project-chat" class="project-chat-container holographic hidden">
            <div class="chat-header">
                <h3 id="project-chat-title">Project: Untitled</h3>
                <div class="chat-controls">
                    <button id="minimize-project-chat" class="chat-control-button">_</button>
                    <button id="close-project-chat" class="chat-control-button">√ó</button>
                </div>
            </div>
            <div id="project-chat-history" class="chat-history">
                <!-- Project-specific messages will be added here -->
            </div>
            <div id="project-typing-indicator" class="typing-indicator hidden">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="chat-input-area">
                <textarea id="project-chat-input" placeholder="Discuss this project..." rows="1"></textarea>
                <button id="project-send-button" class="holo-button send-button">
                    <span class="send-icon">‚ü©</span>
                </button>
            </div>
        </div>
        
        <!-- New Project Modal -->
        <div id="new-project-modal" class="modal hidden">
            <div class="modal-content holographic">
                <div class="modal-header">
                    <h3>Create New Project</h3>
                    <button class="close-modal">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="project-name">Project Name</label>
                        <input type="text" id="project-name" placeholder="Enter project name">
                    </div>
                    <div class="form-group">
                        <label for="project-description">Description</label>
                        <textarea id="project-description" placeholder="Brief description of your project" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="project-type">Project Type</label>
                        <select id="project-type">
                            <option value="research">Research</option>
                            <option value="creative">Creative</option>
                            <option value="technical">Technical</option>
                            <option value="business">Business</option>
                            <option value="personal">Personal</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="create-from-conversation" checked>
                            <span>Create from current conversation</span>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="cancel-project" class="holo-button secondary">Cancel</button>
                    <button id="create-project" class="holo-button primary">Create Project</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/libs/chart.min.js"></script>
    <script src="/static/js/orb-ui/orb-ui-init.js"></script>
    <script src="/static/js/minerva-chat.js"></script>
    <script src="/static/js/minerva-ui-integration.js"></script>
    <script src="/static/js/think-tank-bridge.js"></script>
    <script src="/static/js/model-metrics.js"></script>
    <script src="/static/js/project-context-manager.js"></script>
</body>
</html>
