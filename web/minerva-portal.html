<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minerva Portal</title>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- jQuery for easier DOM manipulation -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <style>
        /* Core styles */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0a0a1a;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Content Sections */
        .content-sections {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .section-panel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            width: 80%;
            max-width: 800px;
            background-color: rgba(15, 15, 35, 0.85);
            border-radius: 15px;
            border: 1px solid rgba(62, 90, 255, 0.3);
            padding: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s, transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: none;
            z-index: 8;
            max-height: 80vh;
            overflow-y: auto;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .section-panel.active {
            opacity: 1;
            pointer-events: auto;
            display: block;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .section-panel h2 {
            color: #7a57d1;
            border-bottom: 1px solid rgba(122, 87, 209, 0.3);
            padding-bottom: 10px;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-content {
            margin-top: 20px;
        }
        
        /* Dashboard styles */
        .stat-cards {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            gap: 20px;
        }
        
        .stat-card {
            flex: 1;
            background-color: rgba(30, 30, 60, 0.7);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #7a57d1;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }
        
        .activity-feed {
            background-color: rgba(25, 25, 45, 0.7);
            border-radius: 10px;
            padding: 20px;
        }
        
        .activity-feed h3 {
            margin-top: 0;
            color: #7a57d1;
            border-bottom: 1px solid rgba(122, 87, 209, 0.3);
            padding-bottom: 10px;
        }
        
        .activity-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        /* Memory styles */
        .memory-list, .project-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .memory-item, .project-item {
            background-color: rgba(30, 30, 60, 0.7);
            border-radius: 10px;
            padding: 15px;
            transition: transform 0.3s;
        }
        
        .memory-item:hover, .project-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Cosmic background */
        .cosmos {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #0f0f2d 0%, #080819 50%, #030308 100%);
            z-index: -2;
        }
        
        /* Stars */
        .stars {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .star {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
            opacity: 0.8;
        }
        
        /* Enhanced draggable Minerva orb */
        .minerva-portal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: conic-gradient(
                #9b30ff,
                #8a2be2,
                #7d26cd,
                #9400d3,
                #800080,
                #9932cc,
                #ba55d3,
                #da70d6,
                #9b30ff
            );
            box-shadow: 
                0 0 30px 5px rgba(155, 48, 255, 0.6),
                0 0 60px 10px rgba(138, 43, 226, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            cursor: grab;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: rotate-gradient 8s linear infinite, pulse-purple 4s infinite alternate;
            overflow: hidden;
            pointer-events: auto;
        }
        
        .minerva-portal.dragging {
            cursor: grabbing;
            opacity: 0.9;
            transition: none;
        }
        
        /* Elliptical orbital pattern */
        @keyframes orbit {
            from { transform: rotate(0deg) translateX(180px) translateY(120px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(180px) translateY(120px) rotate(-360deg); }
        }
        
        /* Portal label and status */
        .portal-label {
            font-size: 1.2rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
            text-align: center;
            line-height: 1.3;
            z-index: 2;
            margin-bottom: 5px;
        }
        
        .orb-status {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            text-align: center;
            z-index: 2;
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            transition: opacity 0.3s ease, color 0.3s ease;
        }
        
        .orb-status.connected {
            color: rgba(62, 255, 130, 1);
            text-shadow: 0 0 8px rgba(62, 255, 130, 0.7);
        }
        
        .orb-status.connecting {
            color: rgba(255, 186, 62, 1);
            text-shadow: 0 0 8px rgba(255, 186, 62, 0.7);
        }
        
        .orb-status.disconnected {
            color: rgba(255, 62, 62, 1);
            text-shadow: 0 0 8px rgba(255, 62, 62, 0.7);
        }
        
        /* Transition states for the orb */
        .minerva-portal.minimized {
            position: fixed;
            top: 30px;
            left: 50%;
            bottom: auto;
            right: auto;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            z-index: 999;
        }
        
        .minerva-portal.section-active {
            position: fixed;
            top: 30px;
            left: 50%;
            bottom: auto;
            right: auto;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            z-index: 999;
        }
        
        .minerva-portal.minimized .portal-label,
        .minerva-portal.section-active .portal-label,
        .minerva-portal.minimized .orb-status,
        .minerva-portal.section-active .orb-status {
            font-size: 0;
            opacity: 0;
        }
        
        .orbital-container.minimized .orbital-item,
        .orbital-container.section-active .orbital-item {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Orb particles layer */
        .orb-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
            opacity: 0.7;
            mix-blend-mode: screen;
        }
        
        .particle {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 4px;
            height: 4px;
        }
        
        .orb-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.15);
            transform: translate(-50%, -50%);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .orb-ring-1 {
            width: 190px;
            height: 190px;
            animation: rotate 60s linear infinite;
        }
        
        .orb-ring-2 {
            width: 220px;
            height: 220px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: rotate 80s linear infinite reverse;
        }
        
        .orb-ring-3 {
            width: 250px;
            height: 250px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            animation: rotate 100s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        @keyframes pulse-purple {
            0% { 
                box-shadow: 
                    0 0 30px 5px rgba(155, 48, 255, 0.6),
                    0 0 60px 10px rgba(138, 43, 226, 0.4); 
            }
            33% {
                box-shadow: 
                    0 0 35px 8px rgba(184, 62, 255, 0.7),
                    0 0 70px 15px rgba(186, 85, 211, 0.5);
            }
            66% {
                box-shadow: 
                    0 0 40px 10px rgba(148, 0, 211, 0.8),
                    0 0 80px 20px rgba(153, 50, 204, 0.6);
            }
            100% { 
                box-shadow: 
                    0 0 45px 12px rgba(128, 0, 128, 0.7),
                    0 0 90px 25px rgba(218, 112, 214, 0.5); 
            }
        }
        
        @keyframes rotate-gradient {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        /* Cosmic inner effect */
        .cosmic-center {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
            z-index: 1;
            overflow: hidden;
        }
        
        .cosmic-star {
            position: absolute;
            background-color: #fff;
            border-radius: 50%;
            opacity: 0;
            animation: cosmic-twinkle 3s infinite;
        }
        
        @keyframes cosmic-twinkle {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        /* Orbital Container */
        .orbital-container {
            position: absolute;
            width: 500px;
            height: 500px;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
            z-index: 9;
        }
        
        /* Orbital Menu Animation - Entry and Exit */
        .orbital-container.expanded .orbital-item {
            opacity: 1;
            transform: translate(0, 0) scale(1);
        }
        
        /* Orbital Items - menu buttons that orbit the central orb */
        .orbital-item {
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: rgba(26, 32, 58, 0.9);
            box-shadow: 0 0 15px rgba(0, 140, 255, 0.7);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            transform: translate(-50%, -50%) scale(0); /* Initialize at center with transform */
            font-size: 1.5rem;
            opacity: 0;
            pointer-events: auto;
            z-index: 10;
            top: 50%;
            left: 50%;
        }
        
        /* Override specific positioning for nth-child to be all the same */
        .orbital-item:nth-child(1),
        .orbital-item:nth-child(2),
        .orbital-item:nth-child(3),
        .orbital-item:nth-child(4),
        .orbital-item:nth-child(5),
        .orbital-item:nth-child(6) {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.5);
            transition-delay: 0s;
        }
        
        /* When an orbital item is selected, highlight it */
        .orbital-item.selected {
            background-color: rgba(50, 65, 120, 0.95);
            box-shadow: 0 0 20px rgba(100, 180, 255, 0.8);
            transform: translate(var(--x), var(--y)) scale(1.1) !important;
        }
        
        /* Position each orbital item with proper calculations for elliptical placement */
        .orbital-item:nth-child(1) { /* Dashboard */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -240px) scale(0.5);
            transition-delay: 0.1s;
        }
        
        .orbital-item:nth-child(2) { /* Memory */
            top: 50%;
            left: 50%;
            transform: translate(180px, -120px) scale(0.5);
            transition-delay: 0.2s;
        }
        
        .orbital-item:nth-child(3) { /* Projects */
            top: 50%;
            left: 50%;
            transform: translate(220px, 50px) scale(0.5);
            transition-delay: 0.3s;
        }
        
        .orbital-item:nth-child(4) { /* Bots */
            top: 50%;
            left: 50%;
            transform: translate(0px, 190px) scale(0.5);
            transition-delay: 0.4s;
        }
        
        .orbital-item:nth-child(5) { /* Search */
            top: 50%;
            left: 50%;
            transform: translate(-220px, 50px) scale(0.5);
            transition-delay: 0.5s;
        }
        
        .orbital-item:nth-child(6) { /* Settings */
            top: 50%;
            left: 50%;
            transform: translate(-180px, -120px) scale(0.5);
            transition-delay: 0.6s;
        }
        
        .orbital-item i {
            font-size: 1.5rem;
            color: #fff;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }
        
        /* Ensure orbital options appear when expanded with correct positioning */
        .orbital-item-animate {
            opacity: 1 !important;
            transform: translate(var(--x), var(--y)) scale(1) !important;
            filter: drop-shadow(0 0 10px rgba(0, 140, 255, 0.7));
            position: absolute !important;
            top: 50% !important;
            left: 50% !important;
        }
        
        /* Floating Chat */
        .chat-panel {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 350px;
            height: 500px;
            background-color: rgba(30, 30, 50, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5),
                        0 0 10px rgba(200, 200, 255, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(200, 200, 220, 0.3);
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: translateY(20px) scale(0.95);
            z-index: 20;
        }
        
        .chat-panel.active {
            opacity: 1;
            pointer-events: auto;
            transform: translateY(0) scale(1);
        }
        
        .chat-header {
            padding: 15px;
            background: linear-gradient(to right, rgba(40, 40, 70, 0.9), rgba(50, 50, 90, 0.9));
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(200, 200, 220, 0.2);
            cursor: move;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
        }
        
        .chat-title {
            font-weight: bold;
        }
        
        .chat-controls {
            display: flex;
            gap: 10px;
        }
        
        .chat-control-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .chat-control-btn:hover {
            opacity: 1;
        }
        
        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            line-height: 1.4;
        }
        
        .message.system {
            background-color: rgba(100, 100, 130, 0.5);
            align-self: center;
            font-style: italic;
            font-size: 0.9rem;
        }
        
        .message.user {
            background-color: rgba(74, 107, 223, 0.7);
            align-self: flex-end;
            border-radius: 18px 18px 0 18px;
        }
        
        .message.minerva {
            background-color: rgba(50, 50, 80, 0.7);
            align-self: flex-start;
            border-radius: 18px 18px 18px 0;
        }
        
        .message.error {
            background-color: rgba(220, 53, 69, 0.7);
            align-self: center;
        }
        
        .chat-input-container {
            padding: 15px;
            display: flex;
            gap: 10px;
            background-color: rgba(25, 25, 50, 0.6);
        }
        
        .chat-input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid rgba(62, 90, 255, 0.3);
            background-color: rgba(30, 30, 60, 0.5);
            color: white;
            outline: none;
        }
        
        .chat-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background-color: rgba(74, 107, 223, 0.8);
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .chat-send-btn:hover {
            background-color: rgba(74, 107, 223, 1);
        }
        
        /* Loading animation */
        .loading-animation {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Keyboard shortcut indicator */
        .keyboard-shortcut {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background-color: rgba(25, 25, 50, 0.7);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            z-index: 100;
        }

        /* Instruction message at bottom of screen */
        .instruction-message {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(25, 25, 50, 0.7);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9);
            z-index: 95;
            backdrop-filter: blur(4px);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
            pointer-events: auto;
            cursor: pointer;
        }

        .instruction-message.visible {
            opacity: 1;
            animation: float 3s ease-in-out infinite;
        }

        .instruction-message:hover {
            background-color: rgba(35, 35, 70, 0.8);
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 0 20px rgba(100, 100, 255, 0.4);
        }

        @keyframes float {
            0% { transform: translateX(-50%) translateY(0px); }
            50% { transform: translateX(-50%) translateY(-5px); }
            100% { transform: translateX(-50%) translateY(0px); }
        }

        .instruction-message .key {
            display: inline-block;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            margin: 0 3px;
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced Silver Orb - more metallic and draggable */
        .chat-orb {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(ellipse at 30% 30%, 
                rgba(255, 255, 255, 0.9) 5%, 
                rgba(220, 220, 220, 0.7) 30%, 
                rgba(170, 170, 190, 0.8) 60%, 
                rgba(150, 150, 170, 0.9) 100%);
            box-shadow: 
                0 0 10px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(192, 192, 192, 0.4),
                inset 2px 2px 15px rgba(255, 255, 255, 0.9),
                inset -2px -2px 15px rgba(0, 0, 0, 0.3);
            cursor: grab;
            z-index: 990;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            transform: scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        .chat-orb.dragging {
            cursor: grabbing;
            opacity: 0.9;
            transition: none;
        }

        .chat-orb:hover {
            transform: scale(1.1);
            box-shadow: 
                0 0 15px rgba(255, 255, 255, 0.9),
                0 0 30px rgba(192, 192, 192, 0.6),
                inset 2px 2px 20px rgba(255, 255, 255, 1),
                inset -2px -2px 20px rgba(0, 0, 0, 0.4);
            animation: pulse-silver 2s infinite alternate;
        }

        @keyframes pulse-silver {
            0% {
                box-shadow: 
                    0 0 10px rgba(255, 255, 255, 0.8),
                    0 0 20px rgba(192, 192, 192, 0.4),
                    inset 2px 2px 15px rgba(255, 255, 255, 0.9),
                    inset -2px -2px 15px rgba(0, 0, 0, 0.3);
            }
            100% {
                box-shadow: 
                    0 0 20px rgba(255, 255, 255, 0.9),
                    0 0 40px rgba(192, 192, 192, 0.6),
                    inset 2px 2px 20px rgba(255, 255, 255, 1),
                    inset -2px -2px 20px rgba(0, 0, 0, 0.4);
            }
        }

        .chat-orb i {
            font-size: 1.8rem;
            color: rgba(50, 50, 80, 0.8);
            text-shadow: 0 1px 2px rgba(255, 255, 255, 0.3);
            pointer-events: none;
        }

        /* Reflection effect on silver orb */
        .chat-orb::after {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 30%;
            height: 30%;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            filter: blur(3px);
            pointer-events: none;
        }

        .chat-panel.active + .chat-orb {
            opacity: 0;
            pointer-events: none;
            display: none;
        }

        /* Add floating animation for orbital items */
        @keyframes float-orbit {
            0% { transform: translate(var(--x), var(--y)) scale(1); }
            50% { transform: translate(var(--x), var(--y)) translateY(-5px) scale(1.05); }
            100% { transform: translate(var(--x), var(--y)) scale(1); }
        }

        @keyframes rotate-orbit {
            0% { transform: translate(var(--x), var(--y)) rotate(0deg); }
            100% { transform: translate(var(--x), var(--y)) rotate(360deg); }
        }

        /* Label for orbital items */
        .orbital-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.6);
            color: #fff;
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        /* Orbital items animation with correct positioning */
        .orbital-item.floating {
            animation: float-orbit 3s ease-in-out infinite;
        }

        .orbital-item.rotating {
            animation: rotate-orbit 20s linear infinite;
        }

        /* Inner content of orbital item should counter-rotate if the item is rotating */
        .orbital-item.rotating i {
            animation: counter-rotate 20s linear infinite;
        }

        @keyframes counter-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-360deg); }
        }

        /* Add styles for full-screen section panels */
        .section-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(15, 20, 40, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            display: none;
            flex-direction: column;
            padding: 30px;
            overflow-y: auto;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease-in-out;
        }

        .section-panel.active {
            display: flex;
            transform: scale(1);
            opacity: 1;
        }

        .section-panel h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: #fff;
            display: flex;
            align-items: center;
        }

        .section-panel h2 i {
            margin-right: 15px;
            font-size: 2rem;
        }

        .section-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px 0;
        }

        /* Back button style */
        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(26, 32, 58, 0.9);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s ease-in-out;
        }

        .back-button i {
            margin-right: 5px;
        }

        .back-button:hover {
            background-color: rgba(50, 65, 120, 0.95);
            transform: scale(1.05);
        }

        /* Dashboard Section Styles */
        #dashboard-section .stat-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            flex: 1;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #fff;
        }

        .stat-label {
            color: #aaa;
            font-size: 1rem;
        }

        .activity-feed {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .activity-feed h3 {
            margin-bottom: 15px;
            color: #fff;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }

        .activity-item {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ddd;
        }

        /* Memory Section Styles */
        .memory-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .memory-item {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            color: #ddd;
            transition: all 0.2s ease-in-out;
        }

        .memory-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        /* Projects Section Styles */
        .project-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .project-item {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            color: #ddd;
            transition: all 0.2s ease-in-out;
        }

        .project-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        /* Bots Section Styles */
        .bots-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .bot-item {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            color: #ddd;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
        }

        .bot-icon {
            width: 50px;
            height: 50px;
            background-color: rgba(50, 65, 120, 0.7);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }

        .bot-info h3 {
            margin: 0 0 5px 0;
            color: #fff;
        }

        .bot-info p {
            margin: 0;
            font-size: 0.9rem;
            color: #aaa;
        }

        .bot-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        /* Search Section Styles */
        .search-container {
            display: flex;
            margin-bottom: 30px;
        }

        .search-container input {
            flex: 1;
            padding: 15px;
            background-color: rgba(26, 32, 58, 0.8);
            border: none;
            border-radius: 5px 0 0 5px;
            color: #fff;
            font-size: 1rem;
        }

        .search-container button {
            background-color: rgba(50, 65, 120, 0.95);
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 0 5px 5px 0;
            cursor: pointer;
        }

        .search-container button:hover {
            background-color: rgba(70, 85, 140, 0.95);
        }

        .search-results {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            color: #ddd;
        }

        /* Settings Section Styles */
        .settings-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .settings-item {
            background-color: rgba(26, 32, 58, 0.8);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            color: #ddd;
        }

        .settings-item h3 {
            margin-top: 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
            color: #fff;
        }

        .settings-control {
            margin: 15px 0;
        }

        .settings-control label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #2196F3;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Add CSS for the new in-place behavior */
        .minerva-portal.section-active-in-place {
            /* Keep position and dimensions */
            width: 100px; /* Slightly smaller than normal */
            height: 100px;
            opacity: 0.9; /* Slightly faded to indicate "background" mode */
            z-index: 50; /* Below section panel but above background */
        }

        .orbital-container.section-active-in-place {
            opacity: 0.7; /* Fade the orbital items a bit */
            pointer-events: none; /* Prevent interaction while section is active */
            z-index: 49; /* Below the Minerva orb but still visible */
        }

        /* Home button style */
        .home-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(155, 48, 255, 0.8);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s ease-in-out;
            z-index: 101; /* Above section content */
            box-shadow: 0 0 15px rgba(155, 48, 255, 0.4);
        }

        .home-button i {
            margin-right: 8px;
        }

        .home-button:hover {
            background-color: rgba(155, 48, 255, 1);
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(155, 48, 255, 0.6);
        }
    </style>
</head>
<body>
    <!-- Cosmic background -->
    <div class="cosmos"></div>
    <div class="stars" id="stars"></div>
    
    <!-- Orbital Rings - visual enhancements -->
    <div class="orb-ring orb-ring-1"></div>
    <div class="orb-ring orb-ring-2"></div>
    <div class="orb-ring orb-ring-3"></div>
    
    <!-- Orbital Container - holds the orb and menu items -->
    <div class="orbital-container" id="orbital-container">
        <!-- Main Minerva Portal - center orb -->
        <div class="minerva-portal" id="minerva-portal">
            <div class="cosmic-center" id="cosmic-center"></div>
            <div class="orb-particles" id="orb-particles"></div>
            <div class="portal-label">Minerva Portal</div>
            <div class="orb-status">Minerva is online</div>
        </div>
        
        <!-- Orbital Menu Items - positioned radially, matching wireframe -->
        <div class="orbital-item" id="dashboard-orbit" data-section="dashboard-section">
            <i class="fas fa-tachometer-alt"></i>
            <div class="orbital-label">Dashboard</div>
        </div>
        <div class="orbital-item" id="memory-orbit" data-section="memory-section">
            <i class="fas fa-brain"></i>
            <div class="orbital-label">Memory</div>
        </div>
        <div class="orbital-item" id="projects-orbit" data-section="projects-section">
            <i class="fas fa-project-diagram"></i>
            <div class="orbital-label">Projects</div>
        </div>
        <div class="orbital-item" id="bots-orbit" data-section="bots-section">
            <i class="fas fa-robot"></i>
            <div class="orbital-label">Bots</div>
        </div>
        <div class="orbital-item" id="search-orbit" data-section="search-section">
            <i class="fas fa-search"></i>
            <div class="orbital-label">Search</div>
        </div>
        <div class="orbital-item" id="settings-orbit" data-section="settings-section">
            <i class="fas fa-cogs"></i>
            <div class="orbital-label">Settings</div>
        </div>
    </div>
    
    <!-- Content Sections -->
    <div class="content-sections">
        <div id="dashboard-section" class="section-panel">
            <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
            <div class="section-content">
                <div class="stat-cards">
                    <div class="stat-card">
                        <div class="stat-value" id="projects-count">0</div>
                        <div class="stat-label">Active Projects</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="memory-count">0</div>
                        <div class="stat-label">Memory Items</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activities-count">0</div>
                        <div class="stat-label">Recent Activities</div>
                    </div>
                </div>
                <div class="activity-feed">
                    <h3>Recent Activity</h3>
                    <div id="activity-list">
                        <div class="activity-item">Loading activities...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="memory-section" class="section-panel">
            <h2><i class="fas fa-brain"></i> Memory</h2>
            <div class="section-content">
                <div class="memory-list" id="memory-list">
                    <div class="memory-item">Loading memories...</div>
                </div>
            </div>
        </div>
        
        <div id="projects-section" class="section-panel">
            <h2><i class="fas fa-project-diagram"></i> Projects</h2>
            <div class="section-content">
                <div class="project-list" id="project-list">
                    <div class="project-item">Loading projects...</div>
                </div>
            </div>
        </div>
        
        <div id="bots-section" class="section-panel">
            <h2><i class="fas fa-robot"></i> Bots</h2>
            <div class="section-content">
                <div class="bots-list" id="bots-list">
                    <div class="bot-item">
                        <div class="bot-icon"><i class="fas fa-robot"></i></div>
                        <div class="bot-info">
                            <h3>Minerva Assistant</h3>
                            <p>Your primary AI assistant</p>
                        </div>
                    </div>
                    <div class="bot-item">
                        <div class="bot-icon"><i class="fas fa-robot"></i></div>
                        <div class="bot-info">
                            <h3>Research Bot</h3>
                            <p>Specialized in data collection</p>
                        </div>
                    </div>
                    <div class="bot-item">
                        <div class="bot-icon"><i class="fas fa-plus-circle"></i></div>
                        <div class="bot-info">
                            <h3>Add New Bot</h3>
                            <p>Create a specialized assistant</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="search-section" class="section-panel">
            <h2><i class="fas fa-search"></i> Search</h2>
            <div class="section-content">
                <div class="search-container">
                    <input type="text" id="global-search" placeholder="Search across all content...">
                    <button id="run-search"><i class="fas fa-search"></i></button>
                </div>
                <div class="search-results" id="search-results">
                    <p>Enter a search term above to begin</p>
                </div>
            </div>
        </div>
        
        <div id="settings-section" class="section-panel">
            <h2><i class="fas fa-cogs"></i> Settings</h2>
            <div class="section-content">
                <div class="settings-list">
                    <div class="settings-item">
                        <h3>Appearance</h3>
                        <div class="settings-control">
                            <label>Dark Mode</label>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-control">
                            <label>Animation Intensity</label>
                            <input type="range" min="0" max="100" value="70" class="slider">
                        </div>
                    </div>
                    
                    <div class="settings-item">
                        <h3>Notifications</h3>
                        <div class="settings-control">
                            <label>Enable Notifications</label>
                            <label class="toggle-switch">
                                <input type="checkbox" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="settings-control">
                            <label>Sound Effects</label>
                            <label class="toggle-switch">
                                <input type="checkbox">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="settings-item">
                        <h3>AI Assistant</h3>
                        <div class="settings-control">
                            <label>Response Verbosity</label>
                            <select class="settings-select">
                                <option>Concise</option>
                                <option selected>Balanced</option>
                                <option>Detailed</option>
                            </select>
                        </div>
                        <div class="settings-control">
                            <label>Memory Retention</label>
                            <select class="settings-select">
                                <option>Session Only</option>
                                <option selected>1 Week</option>
                                <option>1 Month</option>
                                <option>Indefinite</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Floating Chat Panel -->
    <div class="chat-panel" id="chat-panel">
        <div class="chat-header" id="chat-header">
            <div class="chat-title">Minerva Assistant</div>
            <div class="chat-controls">
                <button class="chat-control-btn" id="minimize-chat">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="chat-control-btn" id="close-chat">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="message system" id="welcome-message">
                Welcome to Minerva Assistant. Checking connection status...
            </div>
        </div>
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chat-input" placeholder="Type your message...">
            <button class="chat-send-btn" id="chat-send">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
    
    <!-- Chat Orb - Silver metallic orb for chat access -->
    <div class="chat-orb" id="chat-orb">
        <i class="fas fa-comments"></i>
    </div>
    
    <!-- Keyboard Shortcut Guide -->
    <div class="keyboard-shortcut">
        Press 1-6 for quick navigation
    </div>
    
    <!-- Instruction message at bottom of screen -->
    <div class="instruction-message" id="instruction-message">
        Press <span class="key">SPACE</span> to toggle Minerva Assistant
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <script>
        // Global variables
        window.activeSection = null;
        window.chatVisible = false;
        window.apiConnected = false;
        window.isDragging = false;
        window.isMinervaDragging = false;
        window.isChatOrbDragging = false;
        window.dragOffsetX = 0;
        window.dragOffsetY = 0;
        window.lastPosition = { x: 0, y: 0 };
        window.lastMinervaPosition = { x: 0, y: 0 };
        window.lastChatOrbPosition = { x: 0, y: 0 };
        window.retry = 0;
        window.memory = [];
        window.projects = [];
        window.activities = [];
        window.chatHistory = [];
        window.particles = [];
        window.isOrbitalExpanded = false;
        window.preventClickOutside = false; // Flag to prevent immediate click-outside

        // API URLs
        window.API_BASE_URL = 'http://127.0.0.1:5505'; // Base URL for the API
        window.API_STATUS_URL = `${API_BASE_URL}/api/status`; // API status endpoint
        window.API_CHAT_URL = `${API_BASE_URL}/api/chat`; // Chat endpoint
        window.API_MEMORY_URL = `${API_BASE_URL}/api/memories`; // Memory endpoint
        window.API_PROJECTS_URL = `${API_BASE_URL}/api/projects`; // Projects endpoint

        // Initialize the application
        function init() {
            console.log("Initializing Minerva Portal...");
            
            createStars();
            createOrbParticles();
            createCosmicStars();
            
            // Setup event listeners
            setupEventListeners();
            
            // Clear any saved position BEFORE doing anything else
            lastMinervaPosition = { x: 0, y: 0 };
            localStorage.removeItem('minerva_orb_position');
            
            // IMPORTANT: Position Minerva orb in the absolute center immediately
            console.log("Setting default state: CENTERED and maximized");
            centerMinervaOrb();
            
            // Setup chat controls
            setupChatControls();
            
            // Initialize content for all sections
            initializeAllSectionContent();
            
            // Show orbital menu after a delay to ensure orb is centered first
            setTimeout(() => {
                toggleOrbitalMenu(true);
            }, 300);
            
            // Start auto-refresh of API status
            setInterval(checkApiStatus, 30000);
            
            // Start particle animation
            animateParticles();
            
            // Add handler for chat input
            setupChatHandlers();
            
            console.log("Minerva Portal initialized successfully");
        }

        // Center the Minerva orb in the absolute center of screen
        function centerMinervaOrb() {
            console.log("Centering Minerva orb");
            
            // Remove any minimized or section-active classes
            minervaPortal.classList.remove('minimized');
            minervaPortal.classList.remove('section-active');
            orbitalContainer.classList.remove('minimized');
            orbitalContainer.classList.remove('section-active');
            
            document.querySelectorAll('.orb-ring').forEach(ring => {
                ring.classList.remove('minimized');
                ring.classList.remove('section-active');
            });
            
            // Force absolute center position
            minervaPortal.style.top = '50%';
            minervaPortal.style.left = '50%';
            minervaPortal.style.transform = 'translate(-50%, -50%)';
            
            // Center orbital container as well
            orbitalContainer.style.top = '50%';
            orbitalContainer.style.left = '50%';
            orbitalContainer.style.transform = 'translate(-50%, -50%)';
            
            // Update UI
            const portalLabel = document.querySelector('.portal-label');
            if (portalLabel) {
                portalLabel.textContent = 'Minerva Portal';
            }
        }

        // Toggle orbital menu expansion with perfect circle positioning
        function toggleOrbitalMenu(show) {
            console.log(`Toggle orbital menu: ${show}`);
            
            if (show) {
                console.log("Showing orbital menu");
                isOrbitalExpanded = true;
                
                // Get ALL orbital items as array for easier manipulation
                const orbitalItemsArray = Array.from(orbitalItems);
                console.log(`Total orbital items: ${orbitalItemsArray.length}`);
                
                // Debug each item
                orbitalItemsArray.forEach((item, i) => {
                    console.log(`Item ${i}: ${item.id}, display: ${item.style.display}, opacity: ${item.style.opacity}`);
                });
                
                // Reset all items to a clean state first
                orbitalItemsArray.forEach(item => {
                    // Clear any existing classes and styles
                    item.classList.remove('selected', 'orbital-item-animate', 'floating', 'rotating');
                    item.style.transform = 'translate(-50%, -50%) scale(0.5)'; // Reset transform
                    item.style.position = 'absolute';
                    item.style.top = '50%';
                    item.style.left = '50%';
                    item.style.display = 'flex';
                    item.style.opacity = '0';
                });
                
                // Apply tight orbital positioning
                const totalItems = orbitalItemsArray.length;
                console.log(`Positioning ${totalItems} orbital items in a tighter circle`);
                
                // Tighter radius
                const radius = 140; // Reduced radius for a tighter circle
                
                // Position each item evenly around the circle
                orbitalItemsArray.forEach((item, index) => {
                    // Calculate angle for perfect circle distribution
                    // Start from the top position (270 degrees or -PI/2)
                    const angle = ((index / totalItems) * 2 * Math.PI) - (Math.PI / 2);
                    
                    // Calculate position
                    const x = Math.round(radius * Math.cos(angle));
                    const y = Math.round(radius * Math.sin(angle));
                    
                    // Store position for animation
                    item.style.setProperty('--x', `${x}px`);
                    item.style.setProperty('--y', `${y}px`);
                    
                    // Log position for debugging
                    console.log(`Positioning ${item.id} at angle ${(angle * 180 / Math.PI).toFixed(0)} => (${x}px, ${y}px)`);
                    
                    // Show with animation after a delay for visual staggering
                    setTimeout(() => {
                        // Mark as animated
                        item.style.opacity = '1';
                        item.classList.add('orbital-item-animate');
                        
                        // Add floating or rotating effect
                        if (index % 2 === 0) {
                            item.classList.add('floating');
                        } else {
                            item.classList.add('rotating');
                        }
                        
                        // Debug final state
                        console.log(`${item.id} animated with classes: ${item.className}`);
                    }, 50 * (index + 1));
                });
            } else {
                console.log("Hiding orbital menu");
                isOrbitalExpanded = false;
                
                // Hide all orbital items
                Array.from(orbitalItems).forEach(item => {
                    // Remove animation classes
                    item.classList.remove('selected', 'orbital-item-animate', 'floating', 'rotating');
                    item.style.opacity = '0';
                    
                    // Hide after animation completes
                    setTimeout(() => {
                        item.style.display = 'none';
                    }, 500);
                });
            }
        }

        // Improved Minerva drag function to match silver orb behavior
        function dragMinerva(e) {
            if (!isMinervaDragging) return;
            
            // Update position - use exactly the same approach as silver orb
            const newX = e.clientX - dragOffsetX;
            const newY = e.clientY - dragOffsetY;
            
            // Get viewport dimensions
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // Get orb dimensions
            const minervaWidth = minervaPortal.offsetWidth;
            const minervaHeight = minervaPortal.offsetHeight;
            
            // Calculate strict boundaries to keep orb fully visible
            const leftBoundary = 0;
            const rightBoundary = viewportWidth - minervaWidth;
            const topBoundary = 0;
            const bottomBoundary = viewportHeight - minervaHeight;
            
            // Constrain to viewport boundaries
            const constrainedX = Math.max(leftBoundary, Math.min(newX, rightBoundary));
            const constrainedY = Math.max(topBoundary, Math.min(newY, bottomBoundary));
            
            // Apply new position with no transition for immediate response
            minervaPortal.style.transition = 'none';
            minervaPortal.style.top = constrainedY + 'px';
            minervaPortal.style.left = constrainedX + 'px';
            minervaPortal.style.transform = 'none';
            minervaPortal.style.right = 'auto';
            minervaPortal.style.bottom = 'auto';
            
            // Store position
            lastMinervaPosition = { x: constrainedX, y: constrainedY };
            
            // Update orbital container position to follow Minerva in real-time
            updateOrbitalPositionWhileDragging(constrainedX, constrainedY);
            
            e.preventDefault();
        }

        // Update orbital position during dragging - same as silver orb implementation
        function updateOrbitalPositionWhileDragging(x, y) {
            if (!orbitalContainer) return;
            
            // Calculate the center position for the orbital container
            const minervaWidth = minervaPortal.offsetWidth;
            const minervaHeight = minervaPortal.offsetHeight;
            const orbitalWidth = orbitalContainer.offsetWidth || 500;
            const orbitalHeight = orbitalContainer.offsetHeight || 500;
            
            // Center the orbital container on the Minerva orb
            const centerX = x + (minervaWidth / 2) - (orbitalWidth / 2);
            const centerY = y + (minervaHeight / 2) - (orbitalHeight / 2);
            
            // Apply position directly without transitions during drag
            orbitalContainer.style.transition = 'none';
            orbitalContainer.style.position = 'fixed';
            orbitalContainer.style.top = centerY + 'px';
            orbitalContainer.style.left = centerX + 'px';
            orbitalContainer.style.transform = 'none';
            orbitalContainer.style.right = 'auto';
            orbitalContainer.style.bottom = 'auto';
            orbitalContainer.style.zIndex = '9';
        }

        // Simplified stop dragging function just like silver orb's
        function stopDraggingMinerva() {
            if (!isMinervaDragging) return;
            
            console.log("Stopping Minerva drag");
            isMinervaDragging = false;
            minervaPortal.classList.remove('dragging');
            
            // Save the position to localStorage
            localStorage.setItem('minerva_orb_position', JSON.stringify(lastMinervaPosition));
            
            // Simply restore transitions after a brief delay
            setTimeout(() => {
                minervaPortal.style.transition = '';
                orbitalContainer.style.transition = '';
            }, 10);
        }

        // Setup simpler document event handlers like the silver orb
        document.addEventListener('mousemove', function(e) {
            if (isMinervaDragging) {
                // Direct call to drag function for smoother response
                dragMinerva(e);
                didDrag = true;
            } else if (isChatOrbDragging) {
                dragChatOrb(e);
            }
        });

        // Make Minerva and Chat orbs draggable
        function setupDraggable() {
            console.log("Setting up draggable functionality");
            
            // Variables to track click vs. drag
            let startX = 0;
            let startY = 0;
            let movedDistance = 0;
            const clickThreshold = 5; // Pixels to consider as a drag rather than a click
            
            // Setup Minerva draggable functionality - match silver orb implementation
            minervaPortal.addEventListener('mousedown', function(e) {
                console.log("Minerva mousedown");
                if (e.button !== 0) return; // Only left mouse button
                
                startX = e.clientX;
                startY = e.clientY;
                movedDistance = 0;
                didDrag = false;
                
                const rect = minervaPortal.getBoundingClientRect();
                dragOffsetX = e.clientX - rect.left;
                dragOffsetY = e.clientY - rect.top;
                
                isMinervaDragging = true;
                minervaPortal.classList.add('dragging');
                
                e.preventDefault();
            });
            
            // Prevent click if dragging
            minervaPortal.addEventListener('mouseup', function(e) {
                console.log("Minerva mouseup");
                if (isMinervaDragging) {
                    e.stopPropagation();
                    
                    // If we actually moved significantly, mark as a drag
                    if (movedDistance > clickThreshold) {
                        didDrag = true;
                        e.preventDefault();
                        preventClickOutside = true;
                        setTimeout(() => {
                            didDrag = false;
                            preventClickOutside = false;
                        }, 100);
                    }
                    
                    stopDraggingMinerva();
                }
            });
            
            // Document mouse move handler
            document.addEventListener('mousemove', function(e) {
                if (isMinervaDragging) {
                    // Calculate distance moved
                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    movedDistance = Math.sqrt(dx*dx + dy*dy);
                    
                    // Only update if we've moved enough to be considered a drag
                    if (movedDistance > clickThreshold) {
                        dragMinerva(e);
                    }
                } else if (isChatOrbDragging) {
                    dragChatOrb(e);
                }
            });
            
            document.addEventListener('mouseup', function(e) {
                if (isMinervaDragging) {
                    stopDraggingMinerva();
                }
                if (isChatOrbDragging) {
                    stopDraggingChatOrb();
                }
            });
            
            // Setup Chat Orb draggable functionality - same pattern as Minerva
            if (chatOrb) {
                chatOrb.addEventListener('mousedown', function(e) {
                    console.log("Chat orb mousedown");
                    if (e.button !== 0) return; // Only left mouse button
                    
                    startX = e.clientX;
                    startY = e.clientY;
                    movedDistance = 0;
                    didDrag = false;
                    
                    const rect = chatOrb.getBoundingClientRect();
                    dragOffsetX = e.clientX - rect.left;
                    dragOffsetY = e.clientY - rect.top;
                    
                    isChatOrbDragging = true;
                    chatOrb.classList.add('dragging');
                    
                    e.preventDefault();
                });
                
                chatOrb.addEventListener('mouseup', function(e) {
                    console.log("Chat orb mouseup");
                    if (isChatOrbDragging) {
                        e.stopPropagation();
                        
                        // If we actually moved significantly, mark as a drag
                        if (movedDistance > clickThreshold) {
                            didDrag = true;
                            e.preventDefault();
                            setTimeout(() => {
                                didDrag = false;
                            }, 100);
                        }
                        
                        stopDraggingChatOrb();
                    }
                });
            }
        }

        // Handle all mouse movements
        function handleMouseMove(e) {
            if (isMinervaDragging) {
                dragMinerva(e);
            } else if (isChatOrbDragging) {
                dragChatOrb(e);
            } else if (isDragging) {
                dragChat(e);
            }
        }

        // Handle all mouse up events
        function handleMouseUp() {
            if (isMinervaDragging) {
                stopDraggingMinerva();
            } else if (isChatOrbDragging) {
                stopDraggingChatOrb();
            } else if (isDragging) {
                stopDraggingChat();
            }
        }

        // Make sure DOM is fully loaded before executing any code
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM fully loaded - initializing Minerva Portal');
            
            // Initialize all variables and references
            initializeReferences();
            
            // Debug orbital items - important for seeing all items
            console.log(`Found ${orbitalItems.length} orbital items:`);
            Array.from(orbitalItems).forEach((item, index) => {
                console.log(`${index + 1}: ${item.id} - ${item.getAttribute('data-section')}`);
            });
            
            // Then start the app
            init();
        });
        
        // Initialize all DOM references
        function initializeReferences() {
            // DOM Elements - direct references
            window.chatPanel = document.getElementById('chat-panel');
            window.chatHeader = document.getElementById('chat-header');
            window.chatMessages = document.getElementById('chat-messages');
            window.chatInput = document.getElementById('chat-input');
            window.chatSendBtn = document.getElementById('chat-send');
            window.minervaPortal = document.getElementById('minerva-portal');
            window.orbitalContainer = document.getElementById('orbital-container');
            window.orbitalItems = document.querySelectorAll('.orbital-item');
            window.sectionPanels = document.querySelectorAll('.section-panel');
            window.orbParticles = document.getElementById('orb-particles');
            window.cosmicCenter = document.getElementById('cosmic-center');
            window.instructionMessage = document.querySelector('.instruction-message');
            window.chatOrb = document.getElementById('chat-orb');
            
            console.log('References initialized:', {
                chatPanel: chatPanel,
                minervaPortal: minervaPortal,
                orbitalItems: orbitalItems.length,
                chatOrb: chatOrb
            });
        }

        // Create stars for cosmic background
        function createStars() {
            const starsContainer = document.getElementById('stars');
            if (!starsContainer) {
                console.error("Stars container not found!");
                return;
            }
            
            console.log("Creating stars for background");
            // Clear any existing stars
            starsContainer.innerHTML = '';
            
            // Create stars
            const starCount = 100;
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // Random position
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                
                // Random size
                const size = Math.random() * 2 + 1;
                
                star.style.left = `${x}%`;
                star.style.top = `${y}%`;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                
                // Random twinkle animation delay
                star.style.animation = `twinkle ${Math.random() * 3 + 2}s infinite ${Math.random() * 5}s`;
                
                starsContainer.appendChild(star);
            }
        }

        // Create orb particles
        function createOrbParticles() {
            if (!orbParticles) {
                console.error("Orb particles container not found!");
                return;
            }
            
            console.log("Creating orb particles");
            // Clear existing particles
            orbParticles.innerHTML = '';
            particles = [];
            
            // Create new particles
            const particleCount = 20;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Random position within the orb
                const angle = Math.random() * Math.PI * 2;
                const radius = Math.random() * 70; // Keep particles inside the orb
                const x = Math.cos(angle) * radius + 90; // Center X (half of orb width)
                const y = Math.sin(angle) * radius + 90; // Center Y (half of orb height)
                
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                
                // Random size
                const size = Math.random() * 3 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random opacity
                particle.style.opacity = Math.random() * 0.8 + 0.2;
                
                orbParticles.appendChild(particle);
                
                // Store particle data for animation
                particles.push({
                    element: particle,
                    x: x,
                    y: y,
                    angle: angle,
                    radius: radius,
                    speed: Math.random() * 0.02 + 0.01,
                    size: size
                });
            }
        }

        // Create cosmic stars for center effect
        function createCosmicStars() {
            if (!cosmicCenter) {
                console.error("Cosmic center not found!");
                return;
            }
            
            console.log("Creating cosmic stars");
            // Clear any existing stars
            cosmicCenter.innerHTML = '';
            
            // Create stars
            const starCount = 15;
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'cosmic-star';
                
                // Random position
                const angle = Math.random() * Math.PI * 2;
                const distance = Math.random() * 50; // Distance from center
                const x = Math.cos(angle) * distance + 60; // Center X
                const y = Math.sin(angle) * distance + 60; // Center Y
                
                // Random size
                const size = Math.random() * 4 + 1;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${x}px`;
                star.style.top = `${y}px`;
                
                // Random animation delay
                star.style.animationDelay = `${Math.random() * 3}s`;
                
                cosmicCenter.appendChild(star);
            }
        }

        // Animate particles
        function animateParticles() {
            if (!particles || particles.length === 0) return;
            
            particles.forEach(particle => {
                // Update angle based on speed
                particle.angle += particle.speed;
                
                // Calculate new position
                const x = Math.cos(particle.angle) * particle.radius + 90;
                const y = Math.sin(particle.angle) * particle.radius + 90;
                
                // Update particle position
                particle.element.style.left = `${x}px`;
                particle.element.style.top = `${y}px`;
            });
            
            requestAnimationFrame(animateParticles);
        }

        // Make the Chat orb draggable
        function startDraggingChatOrb(e) {
            console.log("Starting to drag Chat orb");
            isChatOrbDragging = true;
            chatOrb.classList.add('dragging');
            
            // Get current position
            const rect = chatOrb.getBoundingClientRect();
            
            // Calculate offset from the click point to the orb center
            dragOffsetX = e.clientX - rect.left;
            dragOffsetY = e.clientY - rect.top;
            
            e.preventDefault();
        }

        function dragChatOrb(e) {
            if (!isChatOrbDragging) return;
            
            // Update position
            const newX = e.clientX - dragOffsetX;
            const newY = e.clientY - dragOffsetY;
            
            // Get viewport dimensions
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // Get orb dimensions
            const chatOrbWidth = chatOrb.offsetWidth;
            const chatOrbHeight = chatOrb.offsetHeight;
            
            // Constrain to viewport boundaries with a small margin
            const constrainedX = Math.max(0, Math.min(newX, viewportWidth - chatOrbWidth));
            const constrainedY = Math.max(0, Math.min(newY, viewportHeight - chatOrbHeight));
            
            // Apply new position
            chatOrb.style.top = constrainedY + 'px';
            chatOrb.style.left = constrainedX + 'px';
            chatOrb.style.right = 'auto';
            chatOrb.style.bottom = 'auto';
            
            // Store position
            lastChatOrbPosition = { x: constrainedX, y: constrainedY };
            
            e.preventDefault();
        }

        function stopDraggingChatOrb() {
            if (isChatOrbDragging) {
                console.log("Stopping Chat orb drag");
                isChatOrbDragging = false;
                chatOrb.classList.remove('dragging');
                
                // Save the position to localStorage
                localStorage.setItem('chat_orb_position', JSON.stringify(lastChatOrbPosition));
            }
        }

        // Make the chat panel draggable
        function startDraggingChat(e) {
            console.log("Starting to drag Chat panel");
            isDragging = true;
            chatPanel.classList.add('dragging');
            
            // Get current position
            const rect = chatPanel.getBoundingClientRect();
            
            // Calculate offset from the click point to the panel top
            dragOffsetX = e.clientX - rect.left;
            dragOffsetY = e.clientY - rect.top;
            
            e.preventDefault();
        }

        function dragChat(e) {
            if (!isDragging) return;
            
            // Update position
            const newX = e.clientX - dragOffsetX;
            const newY = e.clientY - dragOffsetY;
            
            // Ensure chat stays within viewport
            const maxX = window.innerWidth - chatPanel.offsetWidth;
            const maxY = window.innerHeight - chatPanel.offsetHeight;
            
            const boundedX = Math.max(0, Math.min(newX, maxX));
            const boundedY = Math.max(0, Math.min(newY, maxY));
            
            // Apply new position
            chatPanel.style.left = boundedX + 'px';
            chatPanel.style.top = boundedY + 'px';
            chatPanel.style.right = 'auto';
            chatPanel.style.transform = 'none';
            
            // Store position
            lastPosition = { x: boundedX, y: boundedY };
            
            e.preventDefault();
        }

        function stopDraggingChat() {
            if (isDragging) {
                console.log("Stopping Chat panel drag");
                isDragging = false;
                chatPanel.classList.remove('dragging');
                
                // Save the position to localStorage
                localStorage.setItem('minerva_chat_position', JSON.stringify(lastPosition));
            }
        }

        // Toggle the Minerva orb between centered and minimized states
        function toggleOrbState() {
            console.log("Toggling orb state");
            
            // If orb is minimized or showing a section
            if (minervaPortal.classList.contains('minimized') || 
                minervaPortal.classList.contains('section-active')) {
                maximizeOrb();
            } else {
                // If orb is maximized and no section is active
                if (!activeSection) {
                    minimizeOrb();
                } else {
                    // If a section is active, close it first
                    hideAllSections();
                    minimizeOrb();
                }
            }
            
            // Set flag to prevent immediate click outside
            preventClickOutside = true;
            setTimeout(() => {
                preventClickOutside = false;
            }, 100);
        }

        // Set up event listeners with explicit bindings
        function setupEventListeners() {
            console.log("Setting up event listeners");
            
            // Setup direct draggable functionality
            setupDraggable();
            
            // Setup click handlers for the orbs
            minervaPortal.addEventListener('click', function(e) {
                // Only trigger if not dragging
                if (!isMinervaDragging && !didDrag) {
                    console.log("Minerva orb clicked");
                    e.stopPropagation(); // Prevent click from bubbling to document
                    
                    // If we're in a section, return to home view
                    if (activeSection) {
                        hideSection(activeSection);
                        toggleOrbitalMenu(true);
                    } else if (!isOrbitalExpanded) {
                        // If menu is collapsed, expand it without moving the orb
                        toggleOrbitalMenu(true);
                    } else {
                        // If menu is expanded, collapse it without moving the orb
                        toggleOrbitalMenu(false);
                    }
                }
            });
            
            // Setup click handler for the chat orb
            if (chatOrb) {
                chatOrb.addEventListener('click', function(e) {
                    // Only trigger if not dragging
                    if (!isChatOrbDragging && !didDrag) {
                        console.log("Chat orb clicked");
                        e.preventDefault();
                        e.stopPropagation();
                        toggleChatPanel();
                    }
                });
            }
            
            // Click handlers for orbital items
            orbitalItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Get the section ID from data attribute
                    const sectionId = this.getAttribute('data-section');
                    if (sectionId) {
                        showSection(sectionId);
                    }
                });
            });
            
            // Setup number keys for quick navigation
            document.addEventListener('keydown', function(e) {
                if (e.key >= '1' && e.key <= '6' && !e.ctrlKey && !e.metaKey && !e.altKey) {
                    console.log(`Quick nav key ${e.key} pressed`);
                    const index = parseInt(e.key) - 1;
                    if (index >= 0 && index < orbitalItems.length) {
                        // Trigger click on the orbital item
                        const event = new MouseEvent('click', {
                            'view': window,
                            'bubbles': true,
                            'cancelable': true
                        });
                        orbitalItems[index].dispatchEvent(event);
                    }
                }
            });
            
            // Document click handler to minimize when clicking outside
            document.addEventListener('click', function(e) {
                // Check if clicked element is not inside minervaPortal or any orbital items
                if (!preventClickOutside) {
                    const isClickInsideMinerva = minervaPortal.contains(e.target);
                    const isClickInsideOrbit = Array.from(orbitalItems).some(item => item.contains(e.target));
                    const isClickInsidePanel = Array.from(sectionPanels).some(panel => panel.contains(e.target));
                    
                    if (!isClickInsideMinerva && !isClickInsideOrbit && !isClickInsidePanel) {
                        if (isOrbitalExpanded) {
                            // Just hide the orbital menu without moving the orb
                            toggleOrbitalMenu(false);
                        }
                    }
                }
            });
        }

        // Minimize the orb to the top center
        function minimizeOrb() {
            console.log("Minimizing orb");
            minervaPortal.classList.add('minimized');
            orbitalContainer.classList.add('minimized');
            document.querySelectorAll('.orb-ring').forEach(ring => {
                ring.classList.add('minimized');
            });
            
            // Position at the top center (with transform for centering)
            minervaPortal.style.top = '30px';
            minervaPortal.style.left = '50%';
            minervaPortal.style.transform = 'translateX(-50%)';
            
            // Update orbital container position
            orbitalContainer.style.top = '30px';
            orbitalContainer.style.left = '50%';
            orbitalContainer.style.transform = 'translateX(-50%)';
            
            // Hide all orbital items
            orbitalItems.forEach(item => {
                item.classList.remove('selected');
                item.classList.remove('orbital-item-animate');
                item.style.opacity = '0';
                item.style.display = 'none';
            });
            
            // Hide all sections
            hideAllSections();
            
            // Update state
            isOrbitalExpanded = false;
            
            // Update UI
            const portalLabel = document.querySelector('.portal-label');
            if (portalLabel) {
                portalLabel.textContent = 'Minerva';
            }
            
            // Show instruction message
            showInstructionMessage();
        }

        // Maximize/expand the orb to the center of the screen
        function maximizeOrb() {
            console.log("Maximizing orb");
            minervaPortal.classList.remove('minimized');
            minervaPortal.classList.remove('section-active');
            orbitalContainer.classList.remove('minimized');
            orbitalContainer.classList.remove('section-active');
            
            document.querySelectorAll('.orb-ring').forEach(ring => {
                ring.classList.remove('minimized');
                ring.classList.remove('section-active');
            });
            
            // Position at the center if no saved position
            if (lastMinervaPosition.x === 0 && lastMinervaPosition.y === 0) {
                minervaPortal.style.top = '50%';
                minervaPortal.style.left = '50%';
                minervaPortal.style.transform = 'translate(-50%, -50%)';
                
                // Center orbital container as well
                orbitalContainer.style.top = '50%';
                orbitalContainer.style.left = '50%';
                orbitalContainer.style.transform = 'translate(-50%, -50%)';
            } else {
                // Restore saved position
                minervaPortal.style.top = lastMinervaPosition.y + 'px';
                minervaPortal.style.left = lastMinervaPosition.x + 'px';
                minervaPortal.style.transform = 'none';
                
                // Update orbital container position
                updateOrbitalPosition();
            }
            
            // Reset any existing orbital transforms
            orbitalItems.forEach(item => {
                item.style.transform = '';
                item.classList.remove('selected');
            });
            
            // Show orbital menu with animation - delay slightly to ensure transition works
            setTimeout(() => {
                toggleOrbitalMenu(true);
            }, 100);
            
            // Update UI
            const portalLabel = document.querySelector('.portal-label');
            if (portalLabel) {
                portalLabel.textContent = 'Minerva Portal';
            }
        }

        // Hide all sections
        function hideAllSections() {
            sectionPanels.forEach(panel => {
                panel.classList.remove('active');
            });
            activeSection = null;
            document.body.classList.remove('section-active');
        }

        // Show instruction message
        function showInstructionMessage() {
            // Add visible class
            instructionMessage.classList.add('visible');
            
            // Hide after 5 seconds
            setTimeout(() => {
                instructionMessage.classList.remove('visible');
            }, 5000);
        }

        // Basic check API status function
        async function checkApiStatus() {
            console.log("Checking API status...");
            // Simple placeholder for status check
            return true;
        }

        // Load data from localStorage if available (simplified)
        function loadLocalData() {
            console.log("Loading local data...");
            // For now, we'll just minimize the orb
            setTimeout(() => {
                minimizeOrb();
            }, 100);
        }

        // Toggle the chat panel
        function toggleChatPanel() {
            console.log("Toggling chat panel");
            if (chatPanel.classList.contains('active')) {
                // Hide the chat panel
                chatPanel.classList.remove('active');
                
                // Show the chat orb with animation
                chatOrb.style.opacity = '1';
                chatOrb.style.pointerEvents = 'auto';
                chatOrb.style.display = 'flex';
            } else {
                // Show the chat panel
                chatPanel.classList.add('active');
                
                // Hide the chat orb
                chatOrb.style.opacity = '0';
                chatOrb.style.pointerEvents = 'none';
                
                // Focus on input field
                if (chatInput) {
                    setTimeout(() => {
                        chatInput.focus();
                    }, 300);
                }
                
                // Show welcome message if chat is empty
                if (chatMessages.childElementCount <= 1) {
                    const systemMsg = document.createElement('div');
                    systemMsg.className = 'message minerva';
                    systemMsg.textContent = "Hello! How can I help you today?";
                    chatMessages.appendChild(systemMsg);
                    
                    // Scroll to bottom
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }
            }
        }

        // Show a specific section when an orbital item is clicked
        function showSection(sectionId) {
            console.log(`Showing section: ${sectionId}`);
            
            // Hide all sections first
            hideAllSections();
            
            // Show the selected section
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                activeSection = sectionId;
                
                // Mark the corresponding orbital item as selected
                orbitalItems.forEach(item => {
                    item.classList.remove('selected');
                    if (item.getAttribute('data-section') === sectionId) {
                        item.classList.add('selected');
                    }
                });
                
                // Move Minerva orb to the top only when showing a section
                moveOrbToTop();
                
                // Add active class to show full-screen section panel
                section.classList.add('active');
                document.body.classList.add('section-active');
                
                // Add a home button to return to main view
                if (!section.querySelector('.home-button')) {
                    const homeButton = document.createElement('button');
                    homeButton.className = 'home-button';
                    homeButton.innerHTML = '<i class="fas fa-home"></i> Return Home';
                    homeButton.addEventListener('click', function() {
                        hideSection(sectionId);
                        // Move orb back to its previous position
                        restoreOrbPosition();
                        // Show orbital menu
                        setTimeout(() => {
                            toggleOrbitalMenu(true);
                        }, 300);
                    });
                    section.prepend(homeButton);
                }
            }
        }

        // Hide a specific section
        function hideSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove('active');
                activeSection = null;
                
                // Restore the orb position when leaving a section
                restoreOrbPosition();
                document.body.classList.remove('section-active');
            }
        }

        // Setup chat handlers
        function setupChatHandlers() {
            if (chatInput && chatSendBtn) {
                // Send button click handler
                chatSendBtn.addEventListener('click', sendChatMessage);
                
                // Enter key handler
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
        }

        // Send chat message
        function sendChatMessage() {
            const message = chatInput.value.trim();
            if (message) {
                // Add user message to chat
                const userMsg = document.createElement('div');
                userMsg.className = 'message user';
                userMsg.textContent = message;
                chatMessages.appendChild(userMsg);
                
                // Clear input
                chatInput.value = '';
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Show loading indicator
                const loadingMsg = document.createElement('div');
                loadingMsg.className = 'message minerva';
                loadingMsg.innerHTML = '<div class="loading-animation"></div> Thinking...';
                chatMessages.appendChild(loadingMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Simulate response (replace with actual API call)
                setTimeout(() => {
                    // Remove loading message
                    chatMessages.removeChild(loadingMsg);
                    
                    // Add Minerva response
                    const minervaMsg = document.createElement('div');
                    minervaMsg.className = 'message minerva';
                    
                    // Check for specific questions about Ben or Minerva
                    if (message.toLowerCase().includes('ben') && 
                        (message.toLowerCase().includes('who') || message.toLowerCase().includes('dickinson'))) {
                        minervaMsg.textContent = "Ben Dickinson is the creator of the Minerva project. He's a developer and AI enthusiast focused on creating meaningful interactions between humans and AI systems.";
                    } else if (message.toLowerCase().includes('minerva') && 
                              (message.toLowerCase().includes('what') || message.toLowerCase().includes('who'))) {
                        minervaMsg.textContent = "Minerva is an AI assistant interface designed to provide a beautiful, cosmic-themed experience for interacting with AI systems. I'm part of Ben Dickinson's project to make AI more accessible and intuitive.";
                    } else if (message.toLowerCase().includes('cosmic') || 
                              message.toLowerCase().includes('energy') || 
                              message.toLowerCase().includes('universe')) {
                        minervaMsg.textContent = "The cosmic energy that flows through the universe connects all things. This portal interface was designed to evoke that sense of cosmic interconnectedness, with the orbital elements representing the relationship between different aspects of knowledge and creation.";
                    } else {
                        // Generic responses
                        const responses = [
                            "I'm here to help you navigate your journey through the digital cosmos.",
                            "I'm still learning, but I'm happy to assist with whatever you need.",
                            "That's an interesting question. The Minerva system is designed to help with organization, creativity, and knowledge management.",
                            "I'm your cosmic assistant, here to help you access the wisdom of the digital universe.",
                            "I understand. I'm constantly evolving to better assist you."
                        ];
                        minervaMsg.textContent = responses[Math.floor(Math.random() * responses.length)];
                    }
                    
                    chatMessages.appendChild(minervaMsg);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1500);
            }
        }

        // Setup buttons in chat header
        function setupChatControls() {
            // Close chat button handler
            const closeChat = document.getElementById('close-chat');
            if (closeChat) {
                closeChat.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    toggleChatPanel(); // Hide chat panel, show orb
                });
            }
            
            // Minimize chat button handler
            const minimizeChat = document.getElementById('minimize-chat');
            if (minimizeChat) {
                minimizeChat.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    toggleChatPanel(); // Hide chat panel, show orb
                });
            }
        }

        // Update the dashboard section with content matching the wireframe
        function initializeDashboardContent() {
            const dashboardSection = document.getElementById('dashboard-section');
            if (!dashboardSection) return;
            
            // Set initial stats
            document.getElementById('projects-count').textContent = '3';
            document.getElementById('memory-count').textContent = '15';
            document.getElementById('activities-count').textContent = '7';
            
            // Add sample activities
            const activityList = document.getElementById('activity-list');
            if (activityList) {
                activityList.innerHTML = `
                    <div class="activity-item">Added new memory: "Quantum Computing Research" - 2 hours ago</div>
                    <div class="activity-item">Created project: "Minerva Portal UI" - 1 day ago</div>
                    <div class="activity-item">Accessed bot: "Research Assistant" - 3 days ago</div>
                    <div class="activity-item">Updated memory: "Neural Network Architecture" - 1 week ago</div>
                `;
            }
        }

        // Update the projects section with content matching the wireframe
        function initializeProjectsContent() {
            const projectList = document.getElementById('project-list');
            if (!projectList) return;
            
            projectList.innerHTML = `
                <div class="project-item">
                    <h3>Minerva Portal UI</h3>
                    <p>Interactive cosmic-themed interface for knowledge management</p>
                    <div class="project-stats">Last updated: 2 hours ago</div>
                </div>
                <div class="project-item">
                    <h3>Neural Network Architecture</h3>
                    <p>Research on optimizing deep learning models</p>
                    <div class="project-stats">Last updated: 3 days ago</div>
                </div>
                <div class="project-item">
                    <h3>Quantum Computing</h3>
                    <p>Notes and research on quantum algorithms</p>
                    <div class="project-stats">Last updated: 1 week ago</div>
                </div>
                <div class="project-item">
                    <h3>+ New Project</h3>
                    <p>Create a new project workspace</p>
                </div>
            `;
        }

        // Update the memory section with content matching the wireframe
        function initializeMemoryContent() {
            const memoryList = document.getElementById('memory-list');
            if (!memoryList) return;
            
            memoryList.innerHTML = `
                <div class="memory-item">
                    <h3>Quantum Computing Lecture Notes</h3>
                    <p>Notes from Stanford CS269Q lecture series</p>
                    <div class="memory-meta">Added: April 12, 2023</div>
                </div>
                <div class="memory-item">
                    <h3>Neural Network Architecture Diagram</h3>
                    <p>Visual representation of transformer model</p>
                    <div class="memory-meta">Added: March 28, 2023</div>
                </div>
                <div class="memory-item">
                    <h3>Research Paper: "Attention is All You Need"</h3>
                    <p>Key insights from transformer paper</p>
                    <div class="memory-meta">Added: February 15, 2023</div>
                </div>
                <div class="memory-item">
                    <h3>+ Add New Memory</h3>
                    <p>Store new information</p>
                </div>
            `;
        }

        // Initialize content when app starts
        function initializeAllSectionContent() {
            initializeDashboardContent();
            initializeProjectsContent();
            initializeMemoryContent();
            console.log("Section content initialized");
        }

        // Move the orb to the top of the screen (only when showing a section)
        function moveOrbToTop() {
            // Save current position before moving to top
            const rect = minervaPortal.getBoundingClientRect();
            lastMinervaPosition = { 
                x: rect.left, 
                y: rect.top 
            };
            
            // Position at the top center
            minervaPortal.style.transition = 'all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            minervaPortal.style.top = '30px';
            minervaPortal.style.left = '50%';
            minervaPortal.style.transform = 'translateX(-50%)';
            minervaPortal.classList.add('section-active');
            
            // Hide orbital container
            orbitalContainer.style.opacity = '0';
            orbitalContainer.style.pointerEvents = 'none';
            
            // Hide orbital items
            toggleOrbitalMenu(false);
        }

        // Restore the orb to its previous position
        function restoreOrbPosition() {
            // Don't restore if we don't have a valid position
            if (lastMinervaPosition.x === 0 && lastMinervaPosition.y === 0) {
                return;
            }
            
            // Restore position with smooth transition
            minervaPortal.style.transition = 'all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            minervaPortal.style.top = `${lastMinervaPosition.y}px`;
            minervaPortal.style.left = `${lastMinervaPosition.x}px`;
            minervaPortal.style.transform = 'none';
            minervaPortal.classList.remove('section-active');
            
            // Show the orbital container again
            orbitalContainer.style.opacity = '1';
            orbitalContainer.style.pointerEvents = 'auto';
            
            // Update the orbital container position
            setTimeout(() => {
                updateOrbitalPosition();
            }, 100);
        }
    </script>
</body>
</html>
